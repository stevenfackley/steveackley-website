# steveackley.org

![CSS3](https://img.shields.io/badge/css3-%231572B6.svg?style=for-the-badge&logo=css3&logoColor=white) ![Docker](https://img.shields.io/badge/docker-%232496ED.svg?style=for-the-badge&logo=docker&logoColor=white) ![JavaScript](https://img.shields.io/badge/javascript-%23323330.svg?style=for-the-badge&logo=javascript&logoColor=%23F7DF1E) ![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white) ![Prisma](https://img.shields.io/badge/Prisma-3982CE?style=for-the-badge&logo=Prisma&logoColor=white) ![React](https://img.shields.io/badge/react-%2320232a.svg?style=for-the-badge&logo=react&logoColor=%2361DAFB) ![TailwindCSS](https://img.shields.io/badge/tailwind%20css-%2338B2AC.svg?style=for-the-badge&logo=tailwind-css&logoColor=white) ![TypeScript](https://img.shields.io/badge/typescript-%23007ACC.svg?style=for-the-badge&logo=typescript&logoColor=white)


A modern, mobile-first personal website and blog for Steve Ackley â€” built with Next.js 15, Tailwind CSS, and PostgreSQL.

[](https://nextjs.org/)
[](https://www.typescriptlang.org/)
[](https://tailwindcss.com/)
[](https://www.postgresql.org/)
[](https://www.docker.com/)

---

## âœ¨ Features

- **Bento-box dashboard** â€” Visually engaging CSS Grid home page that showcases skills, projects, and contact links
- **Dark & Light mode** â€” Automatically respects system `prefers-color-scheme`, WCAG AA compliant in both themes
- **Blog** â€” Full-featured blog backed by PostgreSQL with rich-text editing (Tiptap)
- **Admin panel** â€” Secure, single-user CMS at `/admin` for creating, editing, and publishing posts
- **Image uploads** â€” Admin can upload images directly into blog posts; stored in a Docker volume
- **Resume download** â€” Direct PDF download from the home CTA
- **Fully Dockerized** â€” Multi-stage build, docker-compose for local development and production

---

## ğŸ–¥ï¸ Tech Stack

| Layer | Technology |
|---|---|
| Framework | Next.js 15 (App Router) |
| Language | TypeScript 5 |
| Styling | Tailwind CSS 4 |
| Database | PostgreSQL 16 |
| ORM | Prisma 6 |
| Auth | NextAuth.js v5 (Auth.js) |
| Rich Text | Tiptap 2 |
| Containerization | Docker + Docker Compose |

---

## ğŸ“‹ Prerequisites

- **Node.js** 20.x LTS
- **npm** 10.x
- **Docker** 24.x+
- **Docker Compose** v2.x

---

## ğŸš€ Quick Start (Local Development)

### 1. Clone the repository

```bash
git clone https://github.com/yourusername/steveackleyorg.git
cd steveackleyorg
```

### 2. Install dependencies

```bash
npm install
```

### 3. Configure environment variables

```bash
cp .env.example .env.local
```

Edit `.env.local` â€” see [Environment Variables](#-environment-variables) for details.

### 4. Start PostgreSQL with Docker

```bash
docker compose -f docker-compose.dev.yml up -d db
```

### 5. Run database migrations

```bash
npx prisma migrate dev
```

### 6. Create the admin user

```bash
npm run setup:admin
```

You'll be prompted for your email and password. The bcrypt hash will be saved to `.env.local`.

### 7. Start the development server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.  
Admin panel: [http://localhost:3000/admin](http://localhost:3000/admin)

---

## ğŸ³ Docker (Full Stack)

### Start everything with Docker Compose

```bash
# Copy environment template and fill in your values
cp .env.example .env.local

# Start the database only (recommended for local dev)
docker compose -f docker-compose.dev.yml up -d db
npm run dev
```

For a full Docker stack locally:

```bash
# web.env is required by docker-compose.yml
# Create it with your local values:
printf 'DATABASE_URL=postgresql://steveackley:devpassword@db:5432/steveackleydb\nAUTH_SECRET=your-secret-here\nADMIN_PASSWORD_HASH=your-hash-here\n' > web.env

# Also create the postgres secret file
mkdir -p secrets && echo "devpassword" > secrets/postgres_password.txt

docker compose up --build
```

The app will be available at [http://localhost:3000](http://localhost:3000).

### Stop and clean up

```bash
docker compose down
```

### Stop and remove volumes (âš ï¸ destroys all data)

```bash
docker compose down -v
```

### View logs

```bash
docker compose logs -f web   # Application logs
docker compose logs -f db    # Database logs
```

---

## ğŸ”‘ Environment Variables

Copy `.env.example` to `.env.local` (development) or `.env` (Docker production).

| Variable | Required | Description | Example |
|---|---|---|---|
| `DATABASE_URL` | âœ… | PostgreSQL connection string | `postgresql://user:pass@localhost:5432/steveackleydb` |
| `AUTH_SECRET` | âœ… | JWT signing secret (min 32 chars) | `openssl rand -base64 32` |
| `AUTH_URL` | âœ… | Application base URL | `http://localhost:3000` |
| `ADMIN_EMAIL` | âœ… | Admin login email | `stevenfackley@gmail.com` |
| `ADMIN_PASSWORD_HASH` | âœ… | bcrypt hash of admin password | Generated by `npm run setup:admin` |
| `NEXT_PUBLIC_LINKEDIN_URL` | âœ… | LinkedIn profile URL | `https://linkedin.com/in/stevenfackley` |
| `NEXT_PUBLIC_EMAIL` | âœ… | Contact email | `stevenfackley@gmail.com` |
| `NEXT_PUBLIC_P1_OPS_HUB_URL` | âœ… | P1 Ops Hub project URL | `https://p1opshub.example.com` |
| `UPLOAD_DIR` | âœ… | Image upload path | `./uploads` (local) or `/app/uploads` (Docker) |
| `MAX_UPLOAD_SIZE_MB` | âœ… | Max upload size | `5` |

> **Security Note:** Never commit `.env` or `.env.local` files. See [SECURITY.md](./docs/SECURITY.md).

### Generating AUTH_SECRET

```bash
openssl rand -base64 32
```

### Generating ADMIN_PASSWORD_HASH

```bash
npm run setup:admin
# or manually:
node -e "const b=require('bcryptjs');b.hash('yourpassword',12).then(console.log)"
```

---

## ğŸ—„ï¸ Database

### Prisma commands

```bash
# Create and apply a new migration
npx prisma migrate dev --name my-change

# Apply pending migrations (production)
npx prisma migrate deploy

# Open Prisma Studio (database GUI)
npx prisma studio

# Regenerate Prisma client after schema changes
npx prisma generate

# Reset database (âš ï¸ development only â€” deletes all data)
npx prisma migrate reset
```

### Schema overview

```
User    â€” Admin user account (single user, credentials auth)
Post    â€” Blog posts with title, slug, content (HTML), cover image, published flag
```

See `prisma/schema.prisma` for the full schema and `docs/SDD.md` for detailed design.

---

## ğŸ“ Blog Admin Usage

1. Navigate to `/admin/login`
2. Log in with your configured admin credentials
3. **Dashboard** â€” View all posts (drafts + published), with edit/delete/publish actions
4. **New Post** (`/admin/posts/new`)
   - Write with the Tiptap rich-text editor
   - Use the toolbar: headings, bold, italic, lists, code blocks, links
   - Upload images via the image toolbar button (max 5MB, JPEG/PNG/WebP/GIF)
   - Set a cover image, title, and optional excerpt
   - Save as **Draft** or publish immediately
5. **Edit Post** â€” Click any post in the dashboard to edit

---

## ğŸ“ Project Structure

```
steveackleyorg/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (public)/           # Public pages
â”‚   â”‚   â”œâ”€â”€ admin/              # Protected admin pages
â”‚   â”‚   â””â”€â”€ api/                # API routes
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ bento/              # Home dashboard cards
â”‚   â”‚   â”œâ”€â”€ blog/               # Blog components
â”‚   â”‚   â”œâ”€â”€ admin/              # Admin components
â”‚   â”‚   â””â”€â”€ ui/                 # Shared UI primitives
â”‚   â”œâ”€â”€ lib/                    # Server-side utilities
â”‚   â””â”€â”€ types/                  # TypeScript types
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma           # Database schema
â”‚   â””â”€â”€ migrations/             # Migration history
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ entrypoint.sh           # Container startup script
â”‚   â””â”€â”€ seed-admin.js           # Admin user seeding script
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup-admin.ts          # Interactive local admin setup
â”œâ”€â”€ public/
â”‚   â””â”€â”€ resume.pdf              # Resume (place your PDF here)
â”œâ”€â”€ docs/                       # Project documentation
â”‚   â”œâ”€â”€ PRD.md                  # Product Requirements
â”‚   â”œâ”€â”€ SDD.md                  # Software Design
â”‚   â”œâ”€â”€ DATA_FLOW.md            # Data flow diagrams
â”‚   â”œâ”€â”€ SECURITY.md             # Security guidelines
â”‚   â””â”€â”€ deployment/             # Deployment & infrastructure docs
â”‚       â”œâ”€â”€ CLOUDFLARE_TUNNEL_SETUP.md
â”‚       â”œâ”€â”€ CLOUDFLARE_AUTO_CACHE_CLEAR.md
â”‚       â””â”€â”€ SERVER_CONFIG.md
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml          # CI/CD pipeline
â”œâ”€â”€ Dockerfile                  # Multi-stage production build
â”œâ”€â”€ docker-compose.yml          # Production orchestration
â”œâ”€â”€ docker-compose.dev.yml      # Development (DB only)
â”œâ”€â”€ docker-compose.tunnel.yml   # Alternative: cloudflared as Docker container
â”œâ”€â”€ .env.example                # Environment variable template
â”œâ”€â”€ DEPLOYMENT_GUIDE.md         # Full deployment documentation
â”œâ”€â”€ QUICK_DEPLOY.md             # Quick-reference commands
â””â”€â”€ README.md                   # This file
```

---

## ğŸ¨ Design System

The site features a dual-theme design that automatically switches based on the user's OS setting:

| Element | Light Mode | Dark Mode |
|---|---|---|
| Background | `#fafafa` | `#0a0a0a` |
| Card Surface | `#ffffff` | `#141414` |
| Text Primary | `#171717` | `#ededed` |
| Text Secondary | `#525252` | `#a3a3a3` |
| Accent | `#2563eb` (blue) | `#60a5fa` (blue) |
| Border | `#e5e5e5` | `#2a2a2a` |

Typography: Inter (via `next/font` â€” zero CLS)  
Both themes meet WCAG AA contrast requirements (â‰¥ 4.5:1 body text).

---

## ğŸš¢ Production Deployment (AWS + Cloudflare Tunnel)

Production is deployed automatically via GitHub Actions on every push to `main`. The pipeline:

1. Builds the Docker image and pushes it to GitHub Container Registry (GHCR)
2. SSHes into the EC2 instance, writes secrets to `web.env` and `secrets/postgres_password.txt`, pulls the new image, and restarts containers
3. Purges the Cloudflare cache so users immediately see the new build

Traffic is served through a **Cloudflare Tunnel** â€” no ports 80 or 443 are exposed on the server. The `cloudflared` daemon runs as a systemd service and routes traffic to the Next.js container on port 3000.

See [DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md) for the full architecture, CI/CD walkthrough, required GitHub secrets, and troubleshooting steps.

See [QUICK_DEPLOY.md](./QUICK_DEPLOY.md) for copy-paste commands.

### Adding Your Resume

Place your resume PDF at `public/resume.pdf`. It will be served at `/resume.pdf` and linked from the CTA card's "Download Resume" button.

---

## ğŸ”’ Security

See [docs/SECURITY.md](./docs/SECURITY.md) for the full security documentation, including:

- Authentication implementation (NextAuth.js + bcrypt)
- SQL injection prevention (Prisma ORM)
- File upload security (MIME validation, filename sanitization)
- XSS prevention (DOMPurify sanitization)
- Security headers configuration
- Environment variable security

---

## ğŸ“– Documentation

| Document | Description |
|---|---|
| [docs/PRD.md](./docs/PRD.md) | Product Requirements Document |
| [docs/SDD.md](./docs/SDD.md) | Software Design Document |
| [docs/DATA_FLOW.md](./docs/DATA_FLOW.md) | Data Flow Document |
| [docs/SECURITY.md](./docs/SECURITY.md) | Security Guidelines |
| [DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md) | CI/CD, Docker, and infrastructure |
| [QUICK_DEPLOY.md](./QUICK_DEPLOY.md) | Quick-reference deployment commands |
| [docs/deployment/CLOUDFLARE_TUNNEL_SETUP.md](./docs/deployment/CLOUDFLARE_TUNNEL_SETUP.md) | Cloudflare Tunnel configuration |
| [docs/deployment/SERVER_CONFIG.md](./docs/deployment/SERVER_CONFIG.md) | EC2 server configuration |
| [CONTRIBUTING.md](./CONTRIBUTING.md) | Contribution Guidelines |

---

## ğŸ“œ License

Copyright (c) 2025 Steve Ackley. See [LICENSE](./LICENSE) for full terms.

In short: you may fork and use the code as a reference for your own project, but you may not copy it verbatim, and you may not use photographs or likenesses of Steve Ackley or his family under any circumstances.

---

## ğŸ“¬ Contact

- **Website:** [steveackley.org](https://steveackley.org)
- **LinkedIn:** See the site CTA
- **Email:** See the site CTA